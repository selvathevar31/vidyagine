<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>V-SYNC</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function () {
            emailjs.init("1RBlJ5dSeKAbJAqed");
        })();
    </script>
</head>

<body>
    <div id="splashScreen">
        <div class="atom-container">
            <div class="atom-ring ring-1">
                <div class="atom-dot"></div>
            </div>
            <div class="atom-ring ring-2">
                <div class="atom-dot"></div>
            </div>
            <div class="atom-ring ring-3">
                <div class="atom-dot"></div>
            </div>
        </div>

        <div class="splash-content">
            <div class="logo-wrapper">
                <div class="vsync-monogram">V</div>
                <div class="logo-shine"></div>
            </div>
            <div class="brand-text">
                <span class="v-letter">V</span><span class="divider">-</span><span class="sync-text">SYNC</span>
            </div>
            <div class="minimal-loader">
                <div class="loader-bar"></div>
            </div>
        </div>
    </div>

    <div id="authScreen" class="auth-container"
        style="max-width: 900px; margin: 60px auto; padding: 40px; background: var(--bg-card); border-radius: 24px; border: 1px solid var(--border-color);">
        <h2
            style="margin-bottom: 20px; font-size: 32px; background: var(--primary-color);background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; text-align: center;">
            V-SYNC Portal</h2>

        <div style="display: flex; gap: 40px; align-items: flex-start; text-align: left;">

            <div style="flex: 1.2;">

                <div id="loginSection">
                    <h3 style="margin-bottom: 15px; color: var(--text-main); font-size: 20px;">Login</h3>
                    <form onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label>College Email</label>
                            <input type="email" id="loginEmail" placeholder="Enter email..." value="">
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <div class="password-wrapper">
                                <input type="password" id="loginPassword" value="" placeholder="Enter password...">
                                <div class="password-toggle-icon"
                                    onclick="togglePasswordVisibility('loginPassword', this)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                        <circle cx="12" cy="12" r="3"></circle>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="anon-toggle-wrapper">
                            <label class="switch">
                                <input type="checkbox" id="loginAnon">
                                <span class="slider"></span>
                            </label>
                            <div>
                                <span style="font-weight: 700; color: white;">Login as an Anonymous user</span>
                                <div style="font-size: 11px; color: var(--text-secondary);">Mask identity, read & post
                                    only.</div>
                            </div>
                        </div>
                        <div style="text-align: right; margin-bottom: 15px;">
                            <span style="color: var(--primary-color); font-size: 15px; cursor: pointer;"
                                onclick="openForgotModal()">Forgot Password?</span>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px;">Login</button>
                    </form>
                    <p class="auth-toggle-text">
                        Don't have an account? <span class="auth-link"
                            onclick="toggleAuthMode('register')">Register</span>
                    </p>
                </div>

                <div id="registerSection" class="hidden">
                    <h3 style="margin-bottom: 15px; color: var(--text-main); font-size: 20px;">Create Account</h3>
                    <div class="auth-scroll-container">
                        <form onsubmit="handleRegister(event)">
                            <div class="anon-toggle-wrapper">
                                <label class="switch">
                                    <input type="checkbox" id="regAnon">
                                    <span class="slider"></span>
                                </label>
                                <div>
                                    <span style="font-weight: 700; color: white;">Register as Anonymous user</span>
                                    <div style="font-size: 11px; color: var(--text-secondary);">We see your data, but
                                        the public won't.</div>
                                </div>
                            </div>
                            <div class="form-group"><label>Full Name</label><input type="text" id="regName" required>
                            </div>
                            <div class="form-group"><label>College Email</label><input type="email" id="regEmail"
                                    required></div>
                            <div class="form-group">
                                <label>Password</label>
                                <div class="password-wrapper">
                                    <input type="password" id="regPass" required placeholder="Create password...">
                                    <div class="password-toggle-icon"
                                        onclick="togglePasswordVisibility('regPass', this)">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group"><label>Age</label><input type="number" id="regAge" required min="16"
                                max="99"></div>
                        <div class="form-group"><label>Gender</label><select id="regGender" required
                                style="width: 100%; padding: 14px; background: var(--bg-input); border: 1px solid var(--border-color); color: white; border-radius: 12px;">
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select></div>
                    </div>
                    <div class="form-group">
                        <label>Current Year</label>
                        <select id="regYear" required onchange="validateRoleOptions()"
                            style="width: 100%; padding: 14px; background: var(--bg-input); border: 1px solid var(--border-color); color: white; border-radius: 12px;">
                            <option value="" disabled selected>Select Year</option>
                            <option value="FE">First Year (FE)</option>
                            <option value="SE">Second Year (SE)</option>
                            <option value="TE">Third Year (TE)</option>
                            <option value="BE">Fourth Year (BE)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>I am a...</label>
                        <select id="regRole" required
                            style="width: 100%; padding: 14px; background: var(--bg-input); border: 1px solid var(--border-color); color: white; border-radius: 12px; font-family: inherit;">
                            <option value="student" selected>Student</option>
                            <option value="mentor">Mentor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>College / University</label>
                        <select id="regCollege" required
                            style="width: 100%; padding: 14px; background: var(--bg-input); border: 1px solid var(--border-color); color: white; border-radius: 12px; font-family: inherit;">
                            <option value="" disabled selected>Select College</option>
                            <option value="VIT">Vidyalankar Institute of Technology</option>
                            <option value="VSIT">Vidyalankar School of Information Technology</option>
                            <option value="VP">Vidyalankar Polytechnic</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Profile Picture (Optional)</label>
                        <input type="file" id="regFile" accept="image/*" style="display:none;"
                            onchange="document.getElementById('regFileName').innerText = this.files[0].name">
                        <button type="button" class="btn btn-secondary"
                            onclick="document.getElementById('regFile').click()" style="width:100%">Upload
                            Photo</button>
                        <small id="regFileName" style="color:var(--text-secondary);">No file chosen</small>
                    </div>

                    <div class="form-group">
                        <label>Work Experience</label>
                        <div id="workExpContainer"></div>
                        <button type="button" class="btn btn-secondary" onclick="addExperienceField()"
                            style="font-size: 12px; margin-top: 5px;">+ Add Experience</button>
                    </div>
                    <button type="submit" class="btn btn-primary"
                        style="width: 100%; padding: 12px; margin-top: 20px;">Register</button>
                    </form>
                </div>
                <p class="auth-toggle-text">Already have an account? <span class="auth-link"
                        onclick="toggleAuthMode('login')">Login</span></p>
            </div>

        </div>
        <div style="width: 1px; background: var(--border-color); align-self: stretch;"></div>
        <div style="flex: 0.8; display: flex; flex-direction: column;">
            <h3 style="margin-bottom: 15px; color: var(--text-main);">Dev Switcher</h3>
            <p style="font-size:12px; color:var(--text-muted); margin-bottom:10px;">Select any registered account to
                login instantly:</p>
            <div id="devUserList"
                style="display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto; padding-right: 5px;">
                <p style="color: #666; font-size: 13px;">Loading accounts...</p>
            </div>
            <button class="btn btn-secondary" onclick="loadDevUsers()"
                style="margin-top: 15px; font-size: 12px; width: 100%;">‚Üª Refresh List</button>
            <button class="btn btn-danger" onclick="adminWipeDB()"
                style="margin-top: 10px; font-size: 12px; width: 100%; border: 1px solid #ff453a; background: rgba(255, 69, 58, 0.1);">
                Factory Reset (Delete All Data)
            </button>
            <button class="btn btn-secondary" onclick="openAdminPanel()"
                style="margin-top: 10px; font-size: 12px; width: 100%; border: 1px solid #ff453a; color: #ff453a;">
                üëÆ‚Äç‚ôÇÔ∏è Open Admin Dashboard
            </button>
        </div>
    </div>
    </div>

    <div id="appScreen" class="hidden">
        <div class="container">
            <div class="navbar">
                <div class="navbar-brand">
                    <h1>V-SYNC</h1>
                    <p id="userInfo"></p>
                </div>
                <div class="navbar-right">
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <div class="requests-icon-style" onclick="openConnectionsModal()" title="My Connections">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <div class="requests-icon-style" onclick="switchTab('requests')" title="Pending Requests"
                            style="position: relative;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path
                                    d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l8.84-8.84 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                                </path>
                            </svg>
                            <span id="requestBadge" class="notification-badge hidden">0</span>
                        </div>
                        <div id="navProfileContainer" class="profile-circle" onclick="switchTab('profile')"
                            title="My Profile"></div>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-button" onclick="switchTab(event, 'events')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
    </svg>
    <span class="tab-label">Events</span>
</button>
                <button class="tab-button" onclick="switchTab(event, 'chats')">
                    <div style="position: relative;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
                            </path>
                        </svg>
                        <span id="msgBadge" class="notification-badge hidden"
                            style="top: -2px; right: -2px; border: 2px solid var(--bg-card);">0</span>
                    </div>
                    <span class="tab-label">Messages</span>
                </button>

                <button class="tab-button" onclick="switchTab(event, 'community')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <span class="tab-label">Community</span>
                </button>

                <button class="tab-button" onclick="switchTab(event, 'mentors')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
    <span class="tab-label">Explore</span>
</button>
                <button class="tab-button" onclick="switchTab(event, 'leaderboard')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                        <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                        <path d="M4 22h16"></path>
                        <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                        <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                        <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
                    </svg>
                    <span class="tab-label">Leaderboard</span>
                </button>
            </div>

            <div id="mentors" class="tab-content">
                <div class="card" style="margin-bottom: 20px; border: 1px solid var(--border-color); padding: 15px;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                        <span style="font-size:16px; font-weight:700; color:var(--text-main);">Find Connections</span>

                        <button class="btn btn-secondary" onclick="openExploreSortModal()"
                            style="padding: 6px 12px; font-size: 12px; display: flex; align-items: center; gap: 6px; border-radius: 20px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="4" y1="21" x2="4" y2="14"></line>
                                <line x1="4" y1="10" x2="4" y2="3"></line>
                                <line x1="12" y1="21" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12" y2="3"></line>
                                <line x1="20" y1="21" x2="20" y2="16"></line>
                                <line x1="20" y1="12" x2="20" y2="3"></line>
                                <line x1="2" y1="14" x2="6" y2="14"></line>
                                <line x1="10" y1="8" x2="14" y2="8"></line>
                                <line x1="18" y1="16" x2="22" y2="16"></line>
                            </svg>
                            Filter
                        </button>
                    </div>

                    <form id="userSearchForm" onsubmit="handleUserSearch(event)" style="display:flex; gap:10px;">
                        <input type="text" id="searchInput" placeholder="Search by Name..."
                            style="flex-grow: 1; padding: 10px 15px; border-radius: 12px;"
                            oninput="handleUserSearch(event)">
                    </form>
                </div>

                <div id="searchResultsList" class="grid"></div>

            </div>
            <div id="leaderboard" class="tab-content">
                <div style="height: 100%; overflow-y: auto; padding-bottom: 100px;">

                    <div class="card"
                        style="margin-bottom: 20px; text-align:center; padding:20px; background: linear-gradient(135deg, #1C1C1E, #2C2C2E); margin-top: 15px;">
                        <h2 style="font-size:20px; color:var(--text-main); margin-bottom:5px;">üèÜ Top Mentors</h2>
                        <p style="font-size:12px; color:var(--text-secondary);">
                            <span style="color:var(--primary-color); font-weight:bold;">+1</span> per Upvote ‚Ä¢
                            <span style="color:#FFD700; font-weight:bold;">+5</span> per GOATED Answer
                        </p>
                    </div>

                    <div id="leaderboardList" class="grid"
                        style="display: flex; flex-direction: column; gap: 10px; min-height: 200px;">
                    </div>

                    <div id="leaderboardAdminControls"
                        style="display: none; margin-top: 30px; border-top: 1px solid #333; padding-top: 20px; text-align: center;">
                        <p style="color: #ff453a; font-size: 10px; margin-bottom: 10px; font-weight: bold;">ADMIN ZONE
                        </p>
                        <button class="btn btn-danger" onclick="adminResetScores()"
                            style="width: 100%; border: 1px dashed #ff453a; background: rgba(255, 69, 58, 0.1); color: #ff453a;">
                            ‚ôªÔ∏è Reset All Scores to 0
                        </button>
                    </div>

                </div>
            </div>

            <div id="requests" class="tab-content">
                <div id="requestsList"></div>
            </div>

            <div id="chats" class="tab-content">
                <div id="chatMainWrapper">

                    <div id="activeChatsList">
                        <h4 style="padding: 20px 20px 10px 20px; border-bottom: 1px solid var(--border-color);">
                            Active Conversations
                        </h4>

                        <div class="search-bar-container" style="padding: 10px 15px 15px 15px;">
                            <div class="input-with-icon">
                                <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                </svg>

                                <input type="text" id="chatSearchInput" class="form-control"
                                    placeholder="Start a chat with..." oninput="filterChatConnections(event)"
                                    autocomplete="off" style="padding-left: 45px;">
                            </div>
                        </div>

                        <div id="chatsListContent"></div>
                    </div>

                    <div id="messageView">
                        <input type="file" id="chatFileInput" accept="image/*,video/*,.pdf,.doc,.docx,.ppt,.pptx,.txt"
                            style="display: none;" onchange="handleChatFileSelect(this)">

                        <div id="chatHeader"
                            style="padding: 15px 20px; font-weight: 800; font-size: 18px; border-bottom: 1px solid var(--glass-border); background: rgba(0,0,0,0.2); display: flex; align-items: center;">
                            <span class="chat-back-btn" onclick="closeChatView()">‚Üê</span>

                            <div id="chatHeaderInfo">Select a conversation</div>
                        </div>

                        <div id="messagesContainer"></div>

                        <form id="sendMessageForm" onsubmit="handleSendMessage(event)" class="hidden"
                            style="position: relative; padding: 15px; border-top: 1px solid var(--glass-border); display: flex; gap: 10px; background: rgba(0,0,0,0.2); align-items: center;">

                            <input type="hidden" id="selectedChatId">
                            <div id="emojiPicker" class="emoji-picker hidden"></div>

                            <button type="button" class="chat-upload-btn btn-circle"
                                onclick="document.getElementById('chatFileInput').click()"
                                title="Send Media">üì∑</button>
                            <button type="button" class="chat-upload-btn btn-circle" onclick="toggleEmojiPicker()"
                                title="Emoji">üòÄ</button>

                            <textarea id="messageText" placeholder="Type a message..." required
                                style="flex-grow: 1; height: 45px; border-radius: 22px; padding: 12px 20px; resize: none; background: rgba(255,255,255,0.05); border:none; color: white; font-family: inherit; overflow: hidden; resize: none !important;"
                                autocomplete="off"></textarea>

                            <button type="submit" class="btn btn-primary btn-circle" style="font-size: 18px;">‚û§</button>
                        </form>
                    </div>
                </div>
            </div>

            <div id="community" class="tab-content">
                <div id="communityScrollWrapper" style="flex: 1; overflow-y: auto; padding-bottom: 100px;">

                    <div class="center-icon-wrapper" style="padding-top: 15px;">
                        <div style="display: flex; gap: 12px; align-items: center; flex-shrink: 0;">
                            <div class="sort-btn-style" onclick="openSortModal()">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="4" y1="21" x2="4" y2="14"></line>
                                    <line x1="4" y1="10" x2="4" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="12"></line>
                                    <line x1="12" y1="8" x2="12" y2="3"></line>
                                    <line x1="20" y1="21" x2="20" y2="16"></line>
                                    <line x1="20" y1="12" x2="20" y2="3"></line>
                                    <line x1="2" y1="14" x2="6" y2="14"></line>
                                    <line x1="10" y1="8" x2="14" y2="8"></line>
                                    <line x1="18" y1="16" x2="22" y2="16"></line>
                                </svg>
                                <span class="sort-btn-text">Sort</span>
                            </div>
                            <div id="createPostIcon" class="create-icon-style" onclick="openCreatePostModal()">
                                <span style="font-size: 32px; line-height: 1; margin-bottom: 3px;">+</span>
                                <span class="create-icon-text">Post</span>
                            </div>
                        </div>

                        <div class="daily-poll-style" onclick="openDailyPoll()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round"
                                stroke-linejoin="round">
                                <line x1="18" y1="20" x2="18" y2="10"></line>
                                <line x1="12" y1="20" x2="12" y2="4"></line>
                                <line x1="6" y1="20" x2="6" y2="14"></line>
                            </svg>
                            <span>Daily Poll</span>
                        </div>
                    </div>

                    <div id="communityPostsList" style="padding: 0 5px;"></div>
                </div>
            </div>
            <div id="events" class="tab-content">
    <div style="height: 100%; overflow-y: auto; padding-bottom: 100px;">
        
        <div class="card" style="margin: 15px 5px 10px 5px; text-align:center; padding:20px; background: linear-gradient(135deg, #2C2C2E, #1C1C1E); border: 1px solid var(--primary-color);">
            <h2 style="font-size:20px; color:var(--text-main); margin-bottom:5px;">Upcoming Tech Events</h2>
            <p style="font-size:12px; color:var(--text-secondary);">
                Curated from <span style="color:#0A84FF">Devfolio, MSH & College councils</span>
            </p>
        </div>

        <div style="padding: 0 15px 15px 15px; display: flex; justify-content: center;">
            <button class="btn btn-secondary" onclick="openEventFilterModal()" 
                style="border-radius: 20px; padding: 8px 20px; font-size: 13px; display: flex; align-items: center; gap: 8px; border: 1px solid var(--border-color); background: var(--bg-card);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line>
                    <line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line>
                    <line x1="2" y1="14" x2="6" y2="14"></line><line x1="10" y1="8" x2="14" y2="8"></line>
                    <line x1="18" y1="16" x2="22" y2="16"></line>
                </svg>
                Filter & Sort Events
            </button>
        </div>

        <div id="eventsList" class="grid" style="display: flex; flex-direction: column; gap: 15px; padding: 0 5px;">
            </div>

    </div>
</div>

<div id="eventFilterModal" class="modal" style="z-index: 10002;">
    <div class="modal-content" style="max-width: 400px; display: flex; flex-direction: column;">
        <div class="modal-header">Filter Events</div>
        
        <div style="padding: 10px 0;">
            
            <div class="filter-section-title">Location</div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <div class="filter-pill active" id="evFilter_all" onclick="setEventFilter('all')">All</div>
                <div class="filter-pill" id="evFilter_campus" onclick="setEventFilter('campus')">On-Campus</div>
                <div class="filter-pill" id="evFilter_outside" onclick="setEventFilter('outside')">Outside</div>
            </div>

            <div class="filter-section-title">Sort By Date</div>
            <div style="display: flex; gap: 10px;">
                <div class="filter-pill active" id="evSort_soon" onclick="setEventSort('soon')">
                    ‚¨á Earliest
                </div>
                <div class="filter-pill" id="evSort_late" onclick="setEventSort('late')">
                    ‚¨Ü Later On
                </div>
            </div>

        </div>

        <div class="modal-footer" style="margin-top:15px; border-top:1px solid #333; padding-top:15px;">
            <button class="btn btn-secondary" onclick="closeModal('eventFilterModal')">Cancel</button>
            <button class="btn btn-primary" onclick="applyEventFilters()">Apply Results</button>
        </div>
    </div>
</div>
            
            <div id="exploreFilterModal" class="modal" style="z-index: 10002;">
                <div class="modal-content"
                    style="max-width: 400px; max-height: 85vh; display: flex; flex-direction: column;">
                    <div class="modal-header" style="display:flex; justify-content:space-between; align-items:center;">
                        <span>Filter Connections</span>
                        <span class="close-modal-btn" onclick="closeModal('exploreFilterModal')"
                            style="font-size:24px; cursor:pointer; padding:0 10px;">&times;</span>
                    </div>

                    <div style="flex: 1; overflow-y: auto; padding-right: 5px;">

                        <div class="filter-section-title">By Role</div>
                        <div style="display: flex; flex-wrap: wrap;">
                            <div class="filter-pill" id="expRole_student"
                                onclick="toggleExploreFilter('roles', 'student')">Student</div>
                            <div class="filter-pill" id="expRole_mentor"
                                onclick="toggleExploreFilter('roles', 'mentor')">Mentor</div>
                        </div>

                        <div class="filter-section-title">By Year</div>
                        <div style="display: flex; flex-wrap: wrap;">
                            <div class="filter-pill" id="expYear_FE" onclick="toggleExploreFilter('years', 'FE')">FE
                            </div>
                            <div class="filter-pill" id="expYear_SE" onclick="toggleExploreFilter('years', 'SE')">SE
                            </div>
                            <div class="filter-pill" id="expYear_TE" onclick="toggleExploreFilter('years', 'TE')">TE
                            </div>
                            <div class="filter-pill" id="expYear_BE" onclick="toggleExploreFilter('years', 'BE')">BE
                            </div>
                        </div>

                        <div class="filter-section-title">By College</div>
                        <div style="display: flex; flex-wrap: wrap;">
                            <div class="filter-pill" id="expCol_VIT" onclick="toggleExploreFilter('colleges', 'VIT')">
                                VIT</div>
                            <div class="filter-pill" id="expCol_VSIT" onclick="toggleExploreFilter('colleges', 'VSIT')">
                                VSIT</div>
                            <div class="filter-pill" id="expCol_VP" onclick="toggleExploreFilter('colleges', 'VP')">VP
                            </div>
                        </div>

                    </div>

                    <div class="modal-footer" style="margin-top:15px; border-top:1px solid #333; padding-top:15px;">
                        <button class="btn btn-secondary" onclick="clearExploreFilters()">Clear All</button>
                        <button class="btn btn-primary" onclick="applyExploreFilters()">Apply Filters</button>
                    </div>
                </div>
            </div>
            <div id="viewProfileModal" class="modal" style="z-index: 10050;">
                <div class="modal-content"
                    style="padding: 0; background: var(--bg-body); overflow-y: auto; max-height: 85vh; scrollbar-width: none; -ms-overflow-style: none;">

                    <style>
                        #viewProfileModal .modal-content::-webkit-scrollbar {
                            display: none;
                        }
                    </style>

                    <div
                        style="position: relative; padding: 20px 15px; text-align: center; background: linear-gradient(135deg, rgba(10, 132, 255, 0.1), rgba(48, 209, 88, 0.05)); border-bottom: 1px solid var(--border-color);">

                        <div class="close-modal-btn" onclick="closeModal('viewProfileModal')"
                            style="position: absolute; top: 15px; right: 15px; font-size: 24px; cursor: pointer; color: var(--text-secondary); line-height: 1;">
                            &times;</div>

                        <div id="viewProfilePicContainer"
                            style="width: 100px; height: 100px; margin: 0 auto 10px; border-radius: 50%; border: 3px solid var(--bg-card); box-shadow: 0 5px 20px rgba(0,0,0,0.3); overflow: hidden; display: flex; align-items: center; justify-content: center; background: #333;">
                        </div>

                        <h2 id="viewProfileName"
                            style="font-size: 20px; font-weight: 800; margin-bottom: 4px; color: var(--text-main);">User
                            Name</h2>
                        <span id="viewProfileBadge" class="badge" style="font-size: 10px;">STUDENT</span>

                        <div id="viewProfileActions"
                            style="margin-top: 15px; display: flex; justify-content: center; gap: 10px;">
                        </div>
                    </div>

                    <div style="padding: 15px;">
                        <div class="stats-grid-new" style="margin: 0 0 20px 0;">
                            <div class="stat-card-new" style="padding: 10px 5px;">
                                <div class="stat-number-new" id="viewStatConnections" style="font-size: 18px;">0</div>
                                <div class="stat-label-new" style="font-size: 10px;">Connections</div>
                            </div>
                            <div class="stat-card-new" style="padding: 10px 5px;">
                                <div class="stat-number-new" id="viewStatPosts" style="font-size: 18px;">0</div>
                                <div class="stat-label-new" style="font-size: 10px;">Posts</div>
                            </div>
                            <div class="stat-card-new" style="padding: 10px 5px;">
                                <div class="stat-number-new" id="viewStatScore" style="font-size: 18px;">0</div>
                                <div class="stat-label-new" style="font-size: 10px;">Score</div>
                            </div>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <h4
                                style="font-size: 12px; text-transform: uppercase; color: var(--text-secondary); margin-bottom: 8px; font-weight: 700;">
                                Skills</h4>
                            <div id="viewSkillsContainer" class="skills-container-new"></div>
                        </div>

                        <div class="about-section-new" style="margin-bottom: 15px; padding: 15px;">
                            <div class="info-row-new" style="padding: 8px 0; font-size: 13px;">
                                <span class="info-label-new">College</span>
                                <span class="info-value-new" id="viewInfoCollege">--</span>
                            </div>
                            <div class="info-row-new" style="padding: 8px 0; font-size: 13px;">
                                <span class="info-label-new">Year</span>
                                <span class="info-value-new" id="viewInfoYear">--</span>
                            </div>
                            <div class="info-row-new" style="padding: 8px 0; font-size: 13px;">
                                <span class="info-label-new">Member Since</span>
                                <span class="info-value-new" id="viewInfoJoined">--</span>
                            </div>
                        </div>

                        <button class="btn btn-secondary" onclick="shareViewedProfile()"
                            style="width: 100%; font-size: 13px; padding: 10px;">Share Profile</button>
                    </div>
                </div>
            </div>

            <div id="savedPostsModal" class="modal">
                <div class="modal-content" style="height: 90vh; display: flex; flex-direction: column;">
                    <div class="modal-header">
                        <span>Saved Posts</span>
                        <span class="close-modal-btn" onclick="closeModal('savedPostsModal')"
                            style="font-size:24px; cursor:pointer;">&times;</span>
                    </div>
                    <div id="savedPostsList" style="flex: 1; overflow-y: auto; padding-right: 5px;">
                    </div>
                </div>
            </div>

            <div id="sortFilterModal" class="modal" style="z-index: 10002;">
                <div class="modal-content"
                    style="max-width: 400px; max-height: 85vh; display: flex; flex-direction: column;">
                    <div class="modal-header">Sort & Filter Community</div>

                    <div style="flex: 1; overflow-y: auto; padding-right: 5px;">

                        <div class="filter-section-title">Sort By</div>
                        <div style="display: flex; gap: 10px;">

                            <div class="filter-pill active" id="sortBtn_latest" onclick="toggleSort('latest')">
                                <svg viewBox="0 0 24 24">
                                    <path
                                        d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20ZM12.5,7V12.25L17,14.92l-.75,1.23-5-3V7Z" />
                                </svg>
                                <span>Latest</span>
                            </div>

                            <div class="filter-pill" id="sortBtn_upvotes" onclick="toggleSort('upvotes')">
                                <svg viewBox="0 0 24 24">
                                    <path
                                        d="M19.48,13A7.65,7.65,0,0,0,18.9,9.39c-1.39-3-4.22-4.57-4.22-4.57s.3,2.78-1.42,4.5a3.63,3.63,0,0,1-2.61,1.11c-2.66,0-3.37-3.88-3.37-3.88S4.57,8.81,4.57,12.7a7.43,7.43,0,0,0,14.91.3ZM12,22a9.7,9.7,0,0,1-8.32-5.32A9.63,9.63,0,0,1,2.23,12C2.23,6.33,7.31,2,7.31,2S7.23,4.42,9.33,6.53a5.53,5.53,0,0,0,4,1.7,3.12,3.12,0,0,0,.78-.1,12.72,12.72,0,0,0,3.3-2.52s4.42,3.31,4.42,7.55A8.77,8.77,0,0,1,12,22Z" />
                                </svg>
                                <span>Top Voted</span>
                            </div>

                        </div>

                        <div class="filter-section-title">Filter by Year</div>
                        <div style="display: flex; flex-wrap: wrap;">
                            <div class="filter-pill" id="yearBtn_FE" onclick="toggleFilter('year', 'FE')">FE</div>
                            <div class="filter-pill" id="yearBtn_SE" onclick="toggleFilter('year', 'SE')">SE</div>
                            <div class="filter-pill" id="yearBtn_TE" onclick="toggleFilter('year', 'TE')">TE</div>
                            <div class="filter-pill" id="yearBtn_BE" onclick="toggleFilter('year', 'BE')">BE</div>
                        </div>

                        <div class="filter-section-title">Filter by Tags</div>
                        <div id="filterTagsContainer" style="display: flex; flex-wrap: wrap;">
                        </div>
                    </div>

                    <div class="modal-footer" style="margin-top:15px; border-top:1px solid #333; padding-top:15px;">
                        <button class="btn btn-secondary" onclick="clearAllFilters()">Clear All</button>
                        <button class="btn btn-primary" onclick="applyFilters()">Apply Results</button>
                    </div>
                </div>
            </div>
            <div id="profile" class="tab-content">
                <div style="max-width: 1000px; margin: 0 auto; padding: 20px;">

                    <!-- PROFILE HEADER -->
                    <div class="profile-header-new">
                        <div class="profile-pic-wrapper-new">
                            <div id="profilePicContainer"></div>
                        </div>
                        <div class="profile-info-new">
                            <h1 id="profileName">Loading...</h1>
                            <span id="profileBadge" class="profile-badge-new">Student</span>
                            <p class="profile-email-new" id="profileEmail">email@example.com</p>
                        </div>
                    </div>

                    <!-- STATS SECTION -->
                    <div class="stats-grid-new">
                        <div class="stat-card-new">
                            <div class="stat-number-new" id="statConnections">0</div>
                            <div class="stat-label-new">Connections</div>
                        </div>
                        <div class="stat-card-new">
                            <div class="stat-number-new" id="statPosts">0</div>
                            <div class="stat-label-new">Posts</div>
                        </div>
                        <div class="stat-card-new">
                            <div class="stat-number-new" id="statMentors">0</div>
                            <div class="stat-label-new">Mentors</div>
                        </div>
                    </div>

                    <!-- SKILLS SECTION -->
                    <div>
                        <h2 class="section-title-new">Skills & Expertise</h2>
                        <div id="skillsContainer" class="skills-container-new">
                            <div class="empty-state-new">No skills added yet. Click Edit Profile to add your expertise.
                            </div>
                        </div>
                    </div>

                    <!-- ABOUT SECTION -->
                    <div class="about-section-new">
                        <h2 class="section-title-new">Profile Information</h2>
                        <div class="info-row-new">
                            <span class="info-label-new">College</span>
                            <span class="info-value-new" id="infoCollege">Not specified</span>
                        </div>
                        <div class="info-row-new">
                            <span class="info-label-new">Current Year</span>
                            <span class="info-value-new" id="infoYear">Not specified</span>
                        </div>
                        <div class="info-row-new">
                            <span class="info-label-new">Role</span>
                            <span class="info-value-new" id="infoRole">Not specified</span>
                        </div>
                        <div class="info-row-new">
                            <span class="info-label-new">Member Since</span>
                            <span class="info-value-new" id="infoJoined">Recently</span>
                        </div>
                    </div>

                    <!-- ACTION BUTTONS -->
                    <div class="action-buttons-new" style="grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                        <button class="btn-new btn-primary-new" onclick="toggleEditMode()">Edit</button>

                        <button class="btn-new btn-secondary-new" onclick="openSavedPosts()"
                            style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                            </svg>
                            Saved
                        </button>

                        <button class="btn-new btn-secondary-new" onclick="shareProfile()">Share</button>
                    </div>

                    <!-- EDIT MODE FORM (Hidden by default) -->
                    <div id="editForm" class="edit-form-new" style="display: none;">

                        <h2 style="margin-bottom: 25px; font-size: 20px;">Edit Your Profile</h2>

                        <div
                            style="margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color);">
                            <label style="margin-bottom: 10px;">Profile Picture</label>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="document.getElementById('fileInput').click()"
                                    style="font-size: 13px;">
                                    Change Photo
                                </button>
                                <button class="btn btn-danger" onclick="removeProfilePic()"
                                    style="font-size: 13px; background: rgba(255,69,58,0.1); border: 1px solid #ff453a;">
                                    Remove
                                </button>
                            </div>
                            <input type="file" id="fileInput" accept="image/*" style="display: none;"
                                onchange="uploadProfilePic()">
                        </div>
                        <div class="form-group-new">
                            <label>Full Name</label>
                            <input type="text" id="editName" placeholder="Your name...">
                        </div>

                        <div class="form-group-new">
                            <label>College / University</label>
                            <input type="text" id="editCollege" placeholder="Your college...">
                        </div>

                        <div class="form-group-new">
                            <label>Current Year</label>
                            <select id="editYear"
                                style="width: 100%; padding: 12px; background: var(--bg-input); border: 1px solid var(--border-color); color: var(--text-main); border-radius: 12px;">
                                <option value="FE">First Year (FE)</option>
                                <option value="SE">Second Year (SE)</option>
                                <option value="TE">Third Year (TE)</option>
                                <option value="BE">Fourth Year (BE)</option>
                            </select>
                        </div>

                        <div class="form-group-new">
                            <label>Skills & Expertise (comma-separated)</label>
                            <textarea id="editSkills"
                                placeholder="e.g., Python, React, UI Design, Data Science"></textarea>
                        </div>

                        <div style="display: flex; gap: 12px; margin-top: 30px;">
                            <button class="btn-new btn-primary-new" onclick="saveProfile()">Save Changes</button>
                            <button class="btn-new btn-secondary-new" onclick="toggleEditMode()">Cancel</button>
                        </div>
                    </div>

                    <div
                        style="margin-top: 40px; padding-top: 25px; border-top: 1px solid var(--border-color); display: flex; flex-direction: column; align-items: center; gap: 15px;">

                        <button class="btn-new btn-secondary-new" onclick="window.location.reload()"
                            style="width: 100%; max-width: 250px;">
                            Log Out
                        </button>

                        <button class="btn-new btn-danger-new" onclick="deleteAccount()"
                            style="width: 100%; max-width: 250px; font-size: 12px; opacity: 0.8;">
                            Delete Account
                        </button>

                    </div>
                </div>
            </div>

        </div>
    </div>
    </div>

    <div id="connectionsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">My Connections</div>
            <div id="connectionsModalList" style="max-height: 50vh; overflow-y: auto; padding-right: 5px;"></div>
            <div class="modal-footer" style="flex-direction: column; gap: 10px;">
                <button class="btn btn-secondary" style="width: 100%;" onclick="closeModal('connectionsModal')">Close
                    Panel</button>

                <button id="btnResetScores" class="btn btn-danger"
                    style="display: none; width: 100%; border: 1px dashed #ff453a; background: rgba(255, 69, 58, 0.1);"
                    onclick="adminResetScores()">
                    üèÜ Reset Leaderboard Scores
                </button>
            </div>
        </div>
    </div>
    <div id="dailyPollModal" class="modal" style="z-index: 10050;">
        <div class="modal-content"
            style="max-width: 400px; text-align: center; border: 2px solid #FF5722; box-shadow: 0 0 50px rgba(255, 87, 34, 0.2);">

            <div style="margin-bottom: 20px;">
                <span style="font-size: 40px; display: block; animation: flameFlicker 1s infinite alternate;">üî•</span>
                <h2
                    style="font-size: 24px; font-weight: 800; background: linear-gradient(to right, #FF9F0A, #FF375F); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-top: 10px;">
                    DAILY POLL
                </h2>
            </div>

            <div id="pollViewMode">
                <h3 id="pollQuestionDisplay"
                    style="font-size: 20px; font-weight: 700; color: white; margin-bottom: 25px; line-height: 1.4;">
                    Loading today's question...
                </h3>

                <div id="pollOptionsContainer" style="display: flex; flex-direction: column; gap: 12px;">
                </div>

                <p id="pollTotalVotes" style="margin-top: 20px; font-size: 12px; color: #666;">0 Votes</p>

                <button id="btnEditPoll" class="btn" onclick="togglePollEditMode()"
                    style="display: none; margin: 20px auto 0; background: #333; font-size: 12px; padding: 5px 15px;">
                    ‚úèÔ∏è Edit Poll (Admin)
                </button>
            </div>

            <div id="pollEditMode" class="hidden">
                <h4 style="color: #FF5722; margin-bottom: 15px;">Create New Poll</h4>

                <div class="form-group">
                    <input type="text" id="newPollQuestion" placeholder="Enter Question..."
                        style="text-align: center; font-weight: bold; font-size: 16px;">
                </div>

                <div id="pollOptionsList" class="form-group">
                </div>

                <button class="btn btn-secondary" onclick="addPollOptionField()"
                    style="width: 100%; margin-bottom: 15px; border: 1px dashed #555;">
                    + Add Another Option
                </button>

                <div
                    style="display: flex; gap: 10px; justify-content: center; margin-top: 15px; border-top: 1px solid #333; padding-top: 15px;">
                    <button class="btn btn-secondary" onclick="togglePollEditMode()">Cancel</button>
                    <button class="btn btn-primary" onclick="saveNewPoll()">Publish Poll</button>
                </div>
            </div>

            <div style="margin-top: 25px;">
                <button class="btn btn-secondary" style="border: none; background: transparent; color: #888;"
                    onclick="closeModal('dailyPollModal')">Close</button>
            </div>
        </div>
    </div>

    <div id="createPostModal" class="modal">
        <input type="file" id="postFileInput" accept="image/*,video/*,.pdf,.doc,.docx,.ppt,.pptx,.txt"
            style="display: none;" onchange="handlePostFileSelect()">

        <div class="modal-content" style="max-width: 500px; width: 90%; overflow: visible;">
            <div class="modal-header">Create Discussion Post</div>

            <form onsubmit="handleCreatePostSubmit(event)">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="communityPostTitle" required placeholder="What's on your mind?"
                        autocomplete="off">
                </div>

                <div class="form-group" style="margin-bottom: 15px;">
                    <label>Tags (Max 2)</label>
                    <div id="selectedTagsContainer" class="tag-container" style="min-height:30px;"></div>
                    <button type="button" class="btn btn-secondary" onclick="openTagMenu()"
                        style="width: 100%; text-align: left; display:flex; justify-content:space-between; align-items:center;">
                        <span>‚ûï Add Tags</span>
                        <span style="opacity:0.5;">‚Ä∫</span>
                    </button>
                </div>

                <div class="form-group">
                    <label>Details</label>
                    <textarea id="communityPostBody" required placeholder="Share your thoughts..."
                        style="min-height: 100px; resize: none;" autocomplete="off"></textarea>
                </div>

                <div class="form-group" style="margin-bottom:0;">
                    <label>Image (Optional)</label>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <button type="button" class="btn btn-secondary"
                            style="width:auto; font-size:12px; padding: 8px 12px;"
                            onclick="document.getElementById('postFileInput').click()">üì∑ Choose</button>
                        <small id="postFileName"
                            style="color:var(--text-secondary); font-size:11px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width: 80px;">No
                            file</small>
                        <button type="button" id="removePostImgBtn" class="btn btn-danger"
                            style="display:none; padding: 2px 6px; font-size: 10px; border-radius: 4px;"
                            onclick="removePostImage()">‚úï</button>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('createPostModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitPostBtn">Post</button>
                </div>
            </form>
        </div>
    </div>

    <div id="tagSelectionModal" class="modal" style="z-index: 10001;">
        <div class="modal-content"
            style="max-width: 400px; height: 80vh; display: flex; flex-direction: column; padding: 20px;">
            <div class="modal-header" style="flex-shrink: 0;">Select Tags</div>

            <div style="padding-bottom: 15px; flex-shrink: 0;">
                <input type="text" id="tagSearchInput" placeholder="Search tags..." onkeyup="filterTags()"
                    style="width:100%; padding:12px; border-radius:10px; border:1px solid var(--border-color); background:#2a2a2a; color:white; outline:none;">
            </div>

            <div id="tagListArea" style="flex: 1; overflow-y: auto; padding-right: 5px;">
            </div>

            <div class="modal-footer"
                style="margin-top: 15px; border-top: 1px solid #333; padding-top: 15px; flex-shrink: 0;">
                <button type="button" class="btn btn-primary" style="width: 100%;"
                    onclick="closeTagMenu()">Done</button>
            </div>
        </div>
    </div>
    <div id="postDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="postDetailTitle">Post Title</div>
            <div id="postDetailBody"
                style="margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); color: var(--text-secondary); font-size: 16px; line-height: 1.6;">
            </div>
            <h4
                style="margin-bottom: 15px; color: var(--text-main); font-size: 14px; text-transform: uppercase; letter-spacing: 1px;">
                Discussion</h4>
            <div id="commentsList"
                style="max-height: 350px; overflow-y: auto; margin-bottom: 20px; padding-right: 5px;"></div>
            <form onsubmit="handleNewComment(event)">
                <input type="hidden" id="currentPostId">
                <div class="form-group">
                    <textarea id="commentText" placeholder="Add a comment..." required
                        style="min-height: 60px;"></textarea>
                </div>
                <div class="modal-footer" style="justify-content: space-between;">
                    <button type="button" class="btn btn-secondary"
                        onclick="closeModal('postDetailModal')">Close</button>
                    <button type="submit" class="btn btn-primary">Comment</button>
                </div>
            </form>
        </div>
    </div>
    <div id="imageLightbox" class="lightbox" onclick="closeLightbox()">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightboxImg" onclick="event.stopPropagation()" draggable="false"
            ondragstart="return false;">
        <div
            style="position: absolute; bottom: 20px; color: white; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 20px; font-size: 12px; pointer-events: none;">
            Scroll to Zoom ‚Ä¢ Drag to Pan
        </div>
    </div>
    <div id="customContextMenu">
        <button id="btnUnsend" onclick="performUnsend()" style="display:none; color:#ff453a;">Unsend Message</button>
        <button id="btnDeleteChat" onclick="performDeleteChat()" style="display:none; color:#ff453a;">Delete
            Conversation</button>
    </div>
    <div id="confirmModal" class="modal" style="z-index: 11000;">
        <div class="modal-content" style="max-width: 320px; text-align: center; padding: 25px;">
            <h3 id="confirmTitle" style="margin-bottom: 10px; font-size: 20px;">Are you sure?</h3>
            <p id="confirmMessage" style="color: var(--text-secondary); margin-bottom: 25px; font-size: 14px;">This
                action cannot be undone.</p>

            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-danger" onclick="closeConfirmModal()" style="flex: 1;">CANCEL</button>
                <button id="btnConfirmAction" class="btn btn-primary" style="flex: 1;">CONFIRM</button>
            </div>
        </div>
    </div>

    <div id="exitAnonModal" class="modal" style="z-index: 11000;">
        <div class="modal-content" style="max-width: 350px; text-align: center;">
            <h3 style="margin-bottom: 15px; color: var(--text-main);">Exit Anonymous mode</h3>
            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                Enter your password to exit Incognito Mode.
            </p>
            <input type="password" id="exitAnonPassword" placeholder="Enter Password"
                style="margin-bottom: 20px; text-align: center;">
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-secondary" style="flex:1"
                    onclick="document.getElementById('exitAnonModal').classList.remove('active')">Cancel</button>
                <button class="btn btn-primary" style="flex:1" onclick="confirmExitAnon()">Exit</button>
            </div>
        </div>
    </div>
    <div id="forgotPasswordModal" class="modal" style="z-index: 12000;">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <h3 style="margin-bottom: 10px;">Account Recovery</h3>

            <div id="fpStep1">
                <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 20px;">Enter your college email
                    to receive a verification code.</p>
                <input type="email" id="fpEmail" placeholder="Enter email..." style="margin-bottom: 15px;">
                <button class="btn btn-primary" style="width: 100%;" onclick="handleFpsSendOTP()">Send OTP</button>
            </div>

            <div id="fpStep2" class="hidden">
                <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 20px;">Enter the 6-digit code
                    sent to your email.</p>
                <input type="number" id="fpOtpInput" placeholder="123456"
                    style="margin-bottom: 15px; letter-spacing: 5px; text-align: center; font-weight: bold;">
                <button class="btn btn-primary" style="width: 100%;" onclick="handleFpsVerifyOTP()">Verify Code</button>
                <div style="margin-top: 10px; font-size: 12px; color: var(--text-secondary); cursor: pointer;"
                    onclick="resetFpsUI()">Wrong email?</div>
            </div>

            <div id="fpStep3" class="hidden">
                <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 20px;">Create a new password.
                </p>
                <input type="password" id="fpNewPass" placeholder="New Password" style="margin-bottom: 10px;">
                <input type="password" id="fpConfirmPass" placeholder="Confirm Password" style="margin-bottom: 15px;">
                <button class="btn btn-primary" style="width: 100%;" onclick="handleFpsSavePassword()">Reset
                    Password</button>
            </div>

            <div style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 10px;">
                <button class="btn btn-secondary" onclick="closeForgotModal()">Cancel</button>
            </div>
        </div>
    </div>
    <div id="adminPanelModal" class="modal" style="z-index: 12000;">
        <div class="modal-content" style="max-width: 700px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="modal-header"
                style="border-bottom: 1px solid #ff453a; color: #ff453a; display:flex; justify-content:space-between; align-items:center;">
                <span>üëÆ‚Äç‚ôÇÔ∏è Admin Dashboard</span>
                <span id="reportCountBadge"
                    style="font-size:14px; background:#333; padding:4px 10px; border-radius:10px; color:white;">0
                    Reports</span>
            </div>

            <div id="adminReportsList"
                style="flex: 1; overflow-y: auto; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 12px; margin-top: 10px;">
            </div>

            <div class="modal-footer" style="flex-direction: column; gap: 10px;">
                <button class="btn btn-secondary" style="width: 100%;" onclick="closeModal('adminPanelModal')">Close
                    Panel</button>

                <button id="btnResetScores" class="btn btn-danger" ...>
                    ...
                </button>
            </div>
        </div>
    </div>


    <div id="customToast">Action Restricted</div>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="mentorship7.js"></script>

    <style>
    /* 1. Force buttons to stack vertically (Icon on top of Text) */
    .tab-button {
        display: flex !important;
        flex-direction: column !important; /* Stack them */
        align-items: center !important;    /* Center horizontally */
        justify-content: center !important;/* Center vertically */
        text-align: center !important;     /* Ensure text is centered */
        padding: 6px 0 !important;         /* Adjust padding */
        height: auto !important;
    }

    /* 2. Fix the Text Label */
    .tab-button .tab-label {
        font-size: 10px !important;        /* Small clean text */
        font-weight: 600 !important;
        margin-top: 4px !important;        /* Space between icon and text */
        display: block !important;
        width: 100% !important;            /* Span full width to center text properly */
        text-align: center !important;
    }

    /* 3. Fix the Icon Alignment */
    .tab-button svg {
        margin: 0 auto !important;         /* Force icon to middle */
        display: block !important;
        width: 24px !important;
        height: 24px !important;
    }
    
    /* 4. Fix "Messages" Badge wrapper if present */
    .tab-button > div {
        display: flex !important;
        justify-content: center !important;
        width: 100% !important;
    }
</style>

</body>

</html>